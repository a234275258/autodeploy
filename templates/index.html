<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">

    <title>{{ cname }}</title>

    <link rel="shortcut icon" href="/static/img/facio.ico" type="image/x-icon">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
<link href="/static/font-awesome/css/font-awesome.css" rel="stylesheet">
<link href="/static/css/plugins/iCheck/custom.css" rel="stylesheet">
<link href="/static/css/animate.css" rel="stylesheet">
<link href="/static/css/style.css" rel="stylesheet">
<link href="/static/css/colorbox.css" rel="stylesheet">
<link href="/static/css/vaildator/jquery.validator.css" rel="stylesheet">
<link href="/static/css/magnific/magnific-popup.css" rel="stylesheet">
<link href="/static/css/plugins/fullcalendar/fullcalendar.css" rel="stylesheet">
<link href="/static/css/plugins/dropzone/basic.css" rel="stylesheet">
<link href="/static/css/plugins/dropzone/dropzone.css" rel="stylesheet">
    <script src="/static/js/jquery-2.1.1.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/base.js"></script>

<!-- pop windows -->
<script src="/static/js/jquery.colorbox.js"></script>

<!-- validator js -->
<script src="/static/js/validator/jquery.validator.js"></script>
<script src="/static/js/validator/zh_CN.js"></script>
<script src="/static/js/datapicker/bootstrap-datepicker.js"></script>



</head>

<body>

    <div id="wrapper">

    {% include 'left.html' %}


        <div id="page-wrapper" class="gray-bg">
            <div class="row border-bottom">

            {% include 'bar_header.html' %}

            </div>

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-10">
        <h2></h2>
        <ol class="breadcrumb">
            <li>
                <a href="/">仪表盘</a>
            </li>
            <li>

            </li>

        </ol>
    </div>
    <div class="col-sm-2">
    </div>
</div>


<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-sm-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-success pull-right">Users</span>
                    <h5>用户总数</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins"><a href="/user/list/">{{ usercount }}</a></h1>
                    <small>All user</small>
                </div>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-info pull-right">Hosts</span>
                    <h5>主机总数</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins"><a href="/hosts/list/">{{ hostscount }}</a></h1>
                    <small>All host</small>
                </div>
            </div>
        </div>

        <div class="col-sm-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-primary pull-right">Online</span>
                    <h5>在线用户</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins"><a href="/user/list/"> <span id="online_users">{{ onlinecount }}</span></a></h1>

                    <small>Online user</small>
                </div>
            </div>
        </div>

        <div class="col-sm-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-danger pull-right">项目总数</span>
                    <h5>项目总数</h5>
                </div>
                <div class="ibox-content">
                        <h1 class="no-margins"><a href="/project/list/"> <span id="online_hosts">{{ projectcount }}</span></a></h1>
                    <small>Online project</small>
                </div>
            </div>
        </div>
    </div>
   <br>

    <div class="row">
        <div class="col-sm-4">











































            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>主机列表</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-user"></ul>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content ibox-heading">
                    <h3><i class="fa fa-inbox"></i> 所有资产 </h3>
                    <small><i class="fa fa-map-marker"></i> 所有主机信息. </small>
                </div>
                <div class="ibox-content inspinia-timeline">

                            {% if sysinfo == 0 %}
                            <div class="timeline-item">
                                <div class="row">
                                    <div class="col-xs-5 date">
                                        <i class="fa fa-info-circle"></i>
                                        <strong>主机名:</strong>
                                        <br/>
                                        <strong>ip:</strong>
                                        <br/>
                                        <small class="text-navy">类型:</small>
                                        <br>
                                        <small class="text-navy">运行容器:个</small>
                                        <br/>
                                        <small class="text-navy">主机状态:</small>
                                    </div>
                                    <div class="col-xs-7 content no-top-border">
                                        <p class="m-b-xs">资源使用简介</p>
                                        <p>总内存: </p>
                                        <p>可用内存: </p>
                                        <p>CPU空闲率: </p>
                                        <p>总空闲磁盘: </p>
                                    </div>
                                </div>
                            </div>
                            {% else %}

                            {% for i in sysinfo %}
                            <div class="timeline-item">
                                <div class="row">
                                    <div class="col-xs-5 date">
                                        <i class="fa fa-info-circle"></i>
                                        <strong>主机名:{{ i.hostname }}</strong>
                                        <br/>
                                        <strong>ip:{{ i.ip }}</strong>
                                        <br/>
                                        <small class="text-navy">类型:{{ i.type }}</small>
                                        <br>
                                        <small class="text-navy">运行容器:{{ i.container }}个</small>
                                        <br/>
                                        <small class="text-navy">主机状态:{% if i.line == 1 %}在线{% else %}<font color="red">离线</font>{% endif %}</small>
                                    </div>
                                    <div class="col-xs-7 content no-top-border">
                                        <p class="m-b-xs">资源使用简介</p>
                                        <p>总内存: {{ i.physicalm }}</p>
                                        <p>可用内存: {{ i.freem }}</p>
                                        <p>CPU空闲率: {{ i.cpuidle }}%</p>
                                        <p>总空闲磁盘: {{ i.freedisk }}</p>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}









                </div>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>最近用户登录列表</h5>
                    <div class="ibox-tools">
                        <span class="label label-info-light">10 Messages</span>
                       </div>
                </div>
                <div class="ibox-content ibox-heading">
                    <h3><i class="fa fa-paper-plane-o"></i> 登录记录 </h3>
                    <small><i class="fa fa-map-marker"></i> 最近十次登录记录. </small>
                </div>
                <div class="ibox-content">
                    <div>
                        <div class="feed-activity-list">

                            {% for i in userlist %}


                                    <div class="feed-element">
                                        <a href="#" class="pull-left">
                                            <img alt="image" class="img-circle" src="/static/img/root.png">
                                        </a>
                                        <div class="media-body ">

                                                <small class="pull-right"><!--an hour-->
                                                    {% if i.day != 0 %}
                                                        {{ i.day }} days, {{ i.hours }} hours
                                                    {% else %}
                                                        {% if i.hours != '0' %}
                                                            {{ i.hours }} hours, {{ i.minute }} minutes
                                                        {% else %}
                                                            {% if i.minute != '0' %}
                                                                {{ i.minute }} minute, {{ i.second }} seconds
                                                            {% else %}
                                                                {{ i.second }} seconds
                                                            {% endif %}

                                                        {% endif %}

                                                    {% endif %}

                                                    ago</small>

                                            <strong>{{ i.username }}</strong> 登录了本系统 <br>
                                            <small class="text-muted">{{ i.lastlogin|date:"Y-m-d H:i:s" }}</small>

                                        </div>
                                    </div>
                            {% endfor %}

















                            <button id="show" class="btn btn-primary btn-block m-t"><i class="fa fa-arrow-down"></i> 更多 </button>
                                <div id='more' style="display: none">
                                    <br/>
                                    <div class="feed-activity-list">



















                                    </div>
                                </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>最近部署项目列表</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-user"></ul>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content ibox-heading">
                    <h3><i class="fa fa-user"></i> 最近6次部署记录 </h3>
                    <small><i class="fa fa-map-marker"></i> 所有项目最近6次部署记录列表. </small>
                </div>
                <div class="ibox-content inspinia-timeline">

                    {% if pjinfo == 0 %}
                            <div class="timeline-item">
                                <div class="row">
                                    <div class="col-xs-5 date">
                                        <i class="fa fa-info-circle"></i>
                                        <strong>项目</strong>
                                        <br/>
                                        <small class="text-navy">部署0次</small>
                                    </div>
                                    <div class="col-xs-7 content no-top-border">
                                        <p class="m-b-xs">最近一次部署信息</p>
                                        <p></p>
                                        <p>部署用户: </p>
                                        <p>部署日期: </p>
                                        <p>部署日志: </p>
                                    </div>
                                </div>
                            </div>
                    {% else %}

                    {% for i in pjinfo %}
                            <div class="timeline-item">
                                <div class="row">
                                    <div class="col-xs-5 date">
                                        <i class="fa fa-info-circle"></i>
                                        <strong><a href="pjdeploy/edit/?id={{ i.id }}">{{ i.Pro_name }}项目</a></strong>
                                        <br/>
                                        <small class="text-navy">部署{{ i.count }}次</small>
                                    </div>
                                    <div class="col-xs-7 content no-top-border">
                                        <p class="m-b-xs">最近一次部署信息</p>
                                        <p></p>
                                        <a>部署用户: <a href="/user/list/">{{ i.username }}</a></a></p>
                                        <p>部署日期: {{ i.Publish_time }}</p>
                                        <p>部署日志: <a href="javascript:void(0);" onclick="javascript:openwindow('/pjdeploy/deploylog/?id={{ i.id }}','',1000,800);">点击查看</a></p>
                                    </div>
                                </div>
                            </div>
                           {% endfor %}
                            {% endif %}





                </div>
            </div>
        </div>

</div>

{% include 'foot.html' %}

        </div>
    </div>
{{ usercount }}
</body>
    <!-- Mainly scripts -->
<script src="/static/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="/static/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="/static/js/bootstrap-dialog.js"></script>
<script src="/static/js/mindmup-editabletable.js"></script>
<script src="/static/js/plugins/fullcalendar/moment.min.js"></script>
<script src="/static/js/plugins/fullcalendar/fullcalendar.min.js"></script>

<!-- Custom and plugin javascript -->
<script src="/static/js/inspinia.js"></script>
<script src="/static/js/plugins/pace/pace.min.js"></script>

<!-- Peity -->
<script src="/static/js/plugins/peity/jquery.peity.min.js"></script>

<!-- Peity -->
<script src="/static/js/demo/peity-demo.js"></script>

<script src="/static/js/base.js"></script>

<!-- pop windows layer-->
<script src="/static/js/layer/layer.js"></script>

<!-- highcharts -->
<script src="/static/js/highcharts/highcharts.js"></script>


<script src="/static/js/dropzone/dropzone.js"></script>
<!-- active menu -->
<script>
    var url_array = document.location.pathname.split("/");
    s1 = url_array[1];
    s2 = url_array[2];
    if (s1 == ''){
        $('#index').addClass('active')
    } else {
        $("#"+s1).addClass('active');
        $('#'+s1+' .'+s2).addClass('active');
    }
</script>


<script src="/static/js/echarts/echarts.js"></script>
<script>
$(document).ready(function(){
    $('#show').click(function(){
        $('#show').css('display', 'none');
        $('#more').css('display', 'block');
    })
});






</script>

<script type="text/javascript">

function openwindow(url,name,iWidth,iHeight)
{
// url 转向网页的地址
// name 网页名称，可为空
// iWidth 弹出窗口的宽度
// iHeight 弹出窗口的高度
//window.screen.height获得屏幕的高，window.screen.width获得屏幕的宽
var iTop = (window.screen.height-30-iHeight)/2; //获得窗口的垂直位置;
var iLeft = (window.screen.width-10-iWidth)/2; //获得窗口的水平位置;
window.open(url,name,'height='+iHeight+',,innerHeight='+iHeight+',width='+iWidth+',innerWidth='+iWidth+',top='+iTop+',left='+iLeft+',toolbar=no,menubar=no,scrollbars=yes,resizeable=yes,location=no,status=no');
}

</script>

</html>
